import { http, HttpResponse, delay } from "msw";

export const handlers = [
  /**
   * Tình hình sử dụng AI theo tháng của nhân viên
   */
  http.get("/stats/monthly-calendar", async ({ request }) => {
    const url = new URL(request.url);
    const month = url.searchParams.get("month");
    const year = url.searchParams.get("year");
    const employeeCode = url.searchParams.get("employeeCode");

    if (!month || !year || !employeeCode) {
      return new HttpResponse(
        {
          success: false,
          message: "Missing required parameters: month, year, or employeeCode",
        },
        { status: 400 },
      );
    }

    await delay(500); // Giả lập độ trễ 500ms

    return HttpResponse.json({
      success: true,
      source: "mock",
      data: {
        month,
        year,
        // null khi nhân viên không tồn tại
        employeeInfo: {
          EmployeeID: 415,
          EmployeeName: "Trần Xuân Phúc",
          EmployeeCode: employeeCode,
          ShortName: "txphuc",
          PositionName: "Lập trình viên",
        },
        dailyUsage: [
          // August 2025
          {
            date: "2025-08-01",
            day: 1,
            dayOfWeek: 5,
            isWeekend: false,
            hasUsage: true,
            totalRequests: 10,
            clineRequests: 5,
            cursorRequests: 3,
            aiAgentRequests: 1,
            oneAiRequests: 1,
            positionBasedRequests: 10,
            leaveDay: 0,
            isFullDayLeave: false,
            isHalfDayLeave: false,
            isOnLeave: false,
          },
          {
            date: "2025-08-02",
            day: 2,
            dayOfWeek: 6,
            isWeekend: true,
            hasUsage: false,
            totalRequests: 0,
            clineRequests: 0,
            cursorRequests: 0,
            aiAgentRequests: 0,
            oneAiRequests: 0,
            positionBasedRequests: 0,
            leaveDay: 0,
            isFullDayLeave: false,
            isHalfDayLeave: false,
            isOnLeave: false,
          },
          {
            date: "2025-08-03",
            day: 3,
            dayOfWeek: 0,
            isWeekend: true,
            hasUsage: false,
            totalRequests: 0,
            clineRequests: 0,
            cursorRequests: 0,
            aiAgentRequests: 0,
            oneAiRequests: 0,
            positionBasedRequests: 0,
            leaveDay: 0,
            isFullDayLeave: false,
            isHalfDayLeave: false,
            isOnLeave: false,
          },
          {
            date: "2025-08-04",
            day: 4,
            dayOfWeek: 1,
            isWeekend: false,
            hasUsage: true,
            totalRequests: 12,
            clineRequests: 8,
            cursorRequests: 2,
            aiAgentRequests: 2,
            oneAiRequests: 0,
            positionBasedRequests: 12,
            leaveDay: 0,
            isFullDayLeave: false,
            isHalfDayLeave: false,
            isOnLeave: false,
          },
          {
            date: "2025-08-05",
            day: 5,
            dayOfWeek: 2,
            isWeekend: false,
            hasUsage: true,
            totalRequests: 15,
            clineRequests: 10,
            cursorRequests: 5,
            aiAgentRequests: 0,
            oneAiRequests: 0,
            positionBasedRequests: 15,
            leaveDay: 0,
            isFullDayLeave: false,
            isHalfDayLeave: false,
            isOnLeave: false,
          },
          {
            date: "2025-08-06",
            day: 6,
            dayOfWeek: 3,
            isWeekend: false,
            hasUsage: true,
            totalRequests: 8,
            clineRequests: 4,
            cursorRequests: 4,
            aiAgentRequests: 0,
            oneAiRequests: 0,
            positionBasedRequests: 8,
            leaveDay: 0,
            isFullDayLeave: false,
            isHalfDayLeave: false,
            isOnLeave: false,
          },
          {
            date: "2025-08-07",
            day: 7,
            dayOfWeek: 4,
            isWeekend: false,
            hasUsage: true,
            totalRequests: 20,
            clineRequests: 15,
            cursorRequests: 3,
            aiAgentRequests: 2,
            oneAiRequests: 0,
            positionBasedRequests: 20,
            leaveDay: 0,
            isFullDayLeave: false,
            isHalfDayLeave: false,
            isOnLeave: false,
          },
          {
            date: "2025-08-08",
            day: 8,
            dayOfWeek: 5,
            isWeekend: false,
            hasUsage: true,
            totalRequests: 11,
            clineRequests: 7,
            cursorRequests: 4,
            aiAgentRequests: 0,
            oneAiRequests: 0,
            positionBasedRequests: 11,
            leaveDay: 0,
            isFullDayLeave: false,
            isHalfDayLeave: false,
            isOnLeave: false,
          },
          {
            date: "2025-08-09",
            day: 9,
            dayOfWeek: 6,
            isWeekend: true,
            hasUsage: false,
            totalRequests: 0,
            clineRequests: 0,
            cursorRequests: 0,
            aiAgentRequests: 0,
            oneAiRequests: 0,
            positionBasedRequests: 0,
            leaveDay: 0,
            isFullDayLeave: false,
            isHalfDayLeave: false,
            isOnLeave: false,
          },
          {
            date: "2025-08-10",
            day: 10,
            dayOfWeek: 0,
            isWeekend: true,
            hasUsage: false,
            totalRequests: 0,
            clineRequests: 0,
            cursorRequests: 0,
            aiAgentRequests: 0,
            oneAiRequests: 0,
            positionBasedRequests: 0,
            leaveDay: 0,
            isFullDayLeave: false,
            isHalfDayLeave: false,
            isOnLeave: false,
          },
          {
            date: "2025-08-11",
            day: 11,
            dayOfWeek: 1,
            isWeekend: false,
            hasUsage: true,
            totalRequests: 14,
            clineRequests: 9,
            cursorRequests: 5,
            aiAgentRequests: 0,
            oneAiRequests: 0,
            positionBasedRequests: 14,
            leaveDay: 0,
            isFullDayLeave: false,
            isHalfDayLeave: false,
            isOnLeave: false,
          },
          {
            date: "2025-08-12",
            day: 12,
            dayOfWeek: 2,
            isWeekend: false,
            hasUsage: true,
            totalRequests: 18,
            clineRequests: 12,
            cursorRequests: 6,
            aiAgentRequests: 0,
            oneAiRequests: 0,
            positionBasedRequests: 18,
            leaveDay: 0,
            isFullDayLeave: false,
            isHalfDayLeave: false,
            isOnLeave: false,
          },
          {
            date: "2025-08-13",
            day: 13,
            dayOfWeek: 3,
            isWeekend: false,
            hasUsage: true,
            totalRequests: 7,
            clineRequests: 5,
            cursorRequests: 2,
            aiAgentRequests: 0,
            oneAiRequests: 0,
            positionBasedRequests: 7,
            leaveDay: 0,
            isFullDayLeave: false,
            isHalfDayLeave: false,
            isOnLeave: false,
          },
          {
            date: "2025-08-14",
            day: 14,
            dayOfWeek: 4,
            isWeekend: false,
            hasUsage: true,
            totalRequests: 22,
            clineRequests: 18,
            cursorRequests: 4,
            aiAgentRequests: 0,
            oneAiRequests: 0,
            positionBasedRequests: 22,
            leaveDay: 0,
            isFullDayLeave: false,
            isHalfDayLeave: false,
            isOnLeave: false,
          },
          {
            date: "2025-08-15",
            day: 15,
            dayOfWeek: 5,
            isWeekend: false,
            hasUsage: true,
            totalRequests: 9,
            clineRequests: 6,
            cursorRequests: 3,
            aiAgentRequests: 0,
            oneAiRequests: 0,
            positionBasedRequests: 9,
            leaveDay: 0,
            isFullDayLeave: false,
            isHalfDayLeave: false,
            isOnLeave: false,
          },
          {
            date: "2025-08-16",
            day: 16,
            dayOfWeek: 6,
            isWeekend: true,
            hasUsage: false,
            totalRequests: 0,
            clineRequests: 0,
            cursorRequests: 0,
            aiAgentRequests: 0,
            oneAiRequests: 0,
            positionBasedRequests: 0,
            leaveDay: 0,
            isFullDayLeave: false,
            isHalfDayLeave: false,
            isOnLeave: false,
          },
          {
            date: "2025-08-17",
            day: 17,
            dayOfWeek: 0,
            isWeekend: true,
            hasUsage: false,
            totalRequests: 0,
            clineRequests: 0,
            cursorRequests: 0,
            aiAgentRequests: 0,
            oneAiRequests: 0,
            positionBasedRequests: 0,
            leaveDay: 0,
            isFullDayLeave: false,
            isHalfDayLeave: false,
            isOnLeave: false,
          },
          {
            date: "2025-08-18",
            day: 18,
            dayOfWeek: 1,
            isWeekend: false,
            hasUsage: true,
            totalRequests: 13,
            clineRequests: 8,
            cursorRequests: 5,
            aiAgentRequests: 0,
            oneAiRequests: 0,
            positionBasedRequests: 13,
            leaveDay: 0,
            isFullDayLeave: false,
            isHalfDayLeave: false,
            isOnLeave: false,
          },
          {
            date: "2025-08-19",
            day: 19,
            dayOfWeek: 2,
            isWeekend: false,
            hasUsage: true,
            totalRequests: 16,
            clineRequests: 11,
            cursorRequests: 5,
            aiAgentRequests: 0,
            oneAiRequests: 0,
            positionBasedRequests: 16,
            leaveDay: 0,
            isFullDayLeave: false,
            isHalfDayLeave: false,
            isOnLeave: false,
          },
          {
            date: "2025-08-20",
            day: 20,
            dayOfWeek: 3,
            isWeekend: false,
            hasUsage: true,
            totalRequests: 6,
            clineRequests: 4,
            cursorRequests: 2,
            aiAgentRequests: 0,
            oneAiRequests: 0,
            positionBasedRequests: 6,
            leaveDay: 0,
            isFullDayLeave: false,
            isHalfDayLeave: false,
            isOnLeave: false,
          },
          {
            date: "2025-08-21",
            day: 21,
            dayOfWeek: 4,
            isWeekend: false,
            hasUsage: true,
            totalRequests: 25,
            clineRequests: 20,
            cursorRequests: 5,
            aiAgentRequests: 0,
            oneAiRequests: 0,
            positionBasedRequests: 25,
            leaveDay: 0,
            isFullDayLeave: false,
            isHalfDayLeave: false,
            isOnLeave: false,
          },
          {
            date: "2025-08-22",
            day: 22,
            dayOfWeek: 5,
            isWeekend: false,
            hasUsage: true,
            totalRequests: 10,
            clineRequests: 7,
            cursorRequests: 3,
            aiAgentRequests: 0,
            oneAiRequests: 0,
            positionBasedRequests: 10,
            leaveDay: 0,
            isFullDayLeave: false,
            isHalfDayLeave: false,
            isOnLeave: false,
          },
          {
            date: "2025-08-23",
            day: 23,
            dayOfWeek: 6,
            isWeekend: true,
            hasUsage: false,
            totalRequests: 0,
            clineRequests: 0,
            cursorRequests: 0,
            aiAgentRequests: 0,
            oneAiRequests: 0,
            positionBasedRequests: 0,
            leaveDay: 0,
            isFullDayLeave: false,
            isHalfDayLeave: false,
            isOnLeave: false,
          },
          {
            date: "2025-08-24",
            day: 24,
            dayOfWeek: 0,
            isWeekend: true,
            hasUsage: false,
            totalRequests: 0,
            clineRequests: 0,
            cursorRequests: 0,
            aiAgentRequests: 0,
            oneAiRequests: 0,
            positionBasedRequests: 0,
            leaveDay: 0,
            isFullDayLeave: false,
            isHalfDayLeave: false,
            isOnLeave: false,
          },
          {
            date: "2025-08-25",
            day: 25,
            dayOfWeek: 1,
            isWeekend: false,
            hasUsage: true,
            totalRequests: 17,
            clineRequests: 10,
            cursorRequests: 7,
            aiAgentRequests: 0,
            oneAiRequests: 0,
            positionBasedRequests: 17,
            leaveDay: 0,
            isFullDayLeave: false,
            isHalfDayLeave: false,
            isOnLeave: false,
          },
          {
            date: "2025-08-26",
            day: 26,
            dayOfWeek: 2,
            isWeekend: false,
            hasUsage: true,
            totalRequests: 19,
            clineRequests: 13,
            cursorRequests: 6,
            aiAgentRequests: 0,
            oneAiRequests: 0,
            positionBasedRequests: 19,
            leaveDay: 0,
            isFullDayLeave: false,
            isHalfDayLeave: false,
            isOnLeave: false,
          },
          {
            date: "2025-08-27",
            day: 27,
            dayOfWeek: 3,
            isWeekend: false,
            hasUsage: true,
            totalRequests: 5,
            clineRequests: 3,
            cursorRequests: 2,
            aiAgentRequests: 0,
            oneAiRequests: 0,
            positionBasedRequests: 5,
            leaveDay: 0,
            isFullDayLeave: false,
            isHalfDayLeave: false,
            isOnLeave: false,
          },
          {
            date: "2025-08-28",
            day: 28,
            dayOfWeek: 4,
            isWeekend: false,
            hasUsage: true,
            totalRequests: 21,
            clineRequests: 15,
            cursorRequests: 6,
            aiAgentRequests: 0,
            oneAiRequests: 0,
            positionBasedRequests: 21,
            leaveDay: 0,
            isFullDayLeave: false,
            isHalfDayLeave: false,
            isOnLeave: false,
          },
          {
            date: "2025-08-29",
            day: 29,
            dayOfWeek: 5,
            isWeekend: false,
            hasUsage: true,
            totalRequests: 13,
            clineRequests: 9,
            cursorRequests: 4,
            aiAgentRequests: 0,
            oneAiRequests: 0,
            positionBasedRequests: 13,
            leaveDay: 0,
            isFullDayLeave: false,
            isHalfDayLeave: false,
            isOnLeave: false,
          },
          {
            date: "2025-08-30",
            day: 30,
            dayOfWeek: 6,
            isWeekend: true,
            hasUsage: false,
            totalRequests: 0,
            clineRequests: 0,
            cursorRequests: 0,
            aiAgentRequests: 0,
            oneAiRequests: 0,
            positionBasedRequests: 0,
            leaveDay: 0,
            isFullDayLeave: false,
            isHalfDayLeave: false,
            isOnLeave: false,
          },
          {
            date: "2025-08-31",
            day: 31,
            dayOfWeek: 0,
            isWeekend: true,
            hasUsage: false,
            totalRequests: 0,
            clineRequests: 0,
            cursorRequests: 0,
            aiAgentRequests: 0,
            oneAiRequests: 0,
            positionBasedRequests: 0,
            leaveDay: 0,
            isFullDayLeave: false,
            isHalfDayLeave: false,
            isOnLeave: false,
          },
        ],
        summary: {
          totalDaysWithUsage: 23,
          totalWorkingDays: 23,
          totalLeaveDays: 0,
          totalRequests: 269,
          positionBasedTotalRequests: 269,
          totalClineRequests: 269,
          totalCursorRequests: 0,
          totalAiAgentRequests: 0,
          totalOneAiRequests: 0,
        },
      },
    });
  }),

  /**
   * Tình hình sử dụng AI theo dự án
   */
  http.get("/reports/ai-agent/by-project/:projectName/employees", async ({ request, params }) => {
    const url = new URL(request.url);
    const projectName = params.projectName;
    const startDate = url.searchParams.get("startDate");
    const endDate = url.searchParams.get("endDate");

    if (!startDate || !endDate || !projectName) {
      return new HttpResponse(
        {
          success: false,
          message: "Missing required parameters: startDate, endDate, or projectName",
        },
        { status: 400 },
      );
    }

    await delay(1000); // Giả lập độ trễ 500ms

    return HttpResponse.json({
      success: true,
      source: "mock",
      // có thể là mảng rỗng khi không tồn tại dự án
      data: [
        {
          aiAgentTotalRequests: 0,
          clineActMode: 0,
          clinePlanMode: 10,
          clineTotalRequests: 15,
          cursorAgentRequests: 0,
          cursorAskRequests: 0,
          cursorCmdkUsages: 0,
          cursorEditRequests: 0,
          cursorTotalRequests: 0,
          divisionName: "Khối sản phẩm Doanh nghiệp",
          employeeCode: "B06-0381",
          employeeId: 415,
          employeeName: "Phí Hồng Mạnh",
          meetsUsageThreshold: true,
          oneAiTotalRequests: 1,
          positionCategory: "overlap",
          positionName: "Quản lý thi công",
          relevantToolsTotal: 15,
          shortName: "phmanh",
          totalAllToolsRequests: 15,
        },
        {
          aiAgentTotalRequests: 10,
          clineActMode: 20,
          clinePlanMode: 5,
          clineTotalRequests: 25,
          cursorAgentRequests: 1,
          cursorAskRequests: 2,
          cursorCmdkUsages: 3,
          cursorEditRequests: 4,
          cursorTotalRequests: 10,
          divisionName: "Khối sản phẩm Doanh nghiệp",
          employeeCode: "B06-0382",
          employeeId: 416,
          employeeName: "Nguyễn Thị Lan Anh",
          meetsUsageThreshold: false,
          oneAiTotalRequests: 5,
          positionCategory: "developer",
          positionName: "Lập trình viên",
          relevantToolsTotal: 40,
          shortName: "ntlanh",
          totalAllToolsRequests: 40,
        },
        {
          aiAgentTotalRequests: 5,
          clineActMode: 15,
          clinePlanMode: 60,
          clineTotalRequests: 75,
          cursorAgentRequests: 0,
          cursorAskRequests: 0,
          cursorCmdkUsages: 0,
          cursorEditRequests: 0,
          cursorTotalRequests: 0,
          divisionName: "Khối sản phẩm Cá nhân",
          employeeCode: "B07-0001",
          employeeId: 501,
          employeeName: "Trần Văn Bình",
          meetsUsageThreshold: true,
          oneAiTotalRequests: 2,
          positionCategory: "tester",
          positionName: "Nhân viên kiểm thử",
          relevantToolsTotal: 82,
          shortName: "tvbinh",
          totalAllToolsRequests: 82,
        },
        {
          aiAgentTotalRequests: 0,
          clineActMode: 50,
          clinePlanMode: 50,
          clineTotalRequests: 100,
          cursorAgentRequests: 10,
          cursorAskRequests: 5,
          cursorCmdkUsages: 2,
          cursorEditRequests: 3,
          cursorTotalRequests: 20,
          divisionName: "Khối Công nghệ thông tin",
          employeeCode: "B08-0110",
          employeeId: 610,
          employeeName: "Lê Hoàng Cường",
          meetsUsageThreshold: true,
          oneAiTotalRequests: 15,
          positionCategory: "manager",
          positionName: "Trưởng phòng",
          relevantToolsTotal: 135,
          shortName: "lhcuong",
          totalAllToolsRequests: 135,
        },
        {
          aiAgentTotalRequests: 2,
          clineActMode: 5,
          clinePlanMode: 10,
          clineTotalRequests: 15,
          cursorAgentRequests: 0,
          cursorAskRequests: 0,
          cursorCmdkUsages: 0,
          cursorEditRequests: 0,
          cursorTotalRequests: 0,
          divisionName: "Khối sản phẩm Doanh nghiệp",
          employeeCode: "B06-0400",
          employeeId: 430,
          employeeName: "Phạm Thị Dung",
          meetsUsageThreshold: false,
          oneAiTotalRequests: 0,
          positionCategory: "developer",
          positionName: "Lập trình viên",
          relevantToolsTotal: 15,
          shortName: "ptdung",
          totalAllToolsRequests: 15,
        },
        {
          aiAgentTotalRequests: 30,
          clineActMode: 30,
          clinePlanMode: 30,
          clineTotalRequests: 60,
          cursorAgentRequests: 5,
          cursorAskRequests: 5,
          cursorCmdkUsages: 5,
          cursorEditRequests: 5,
          cursorTotalRequests: 20,
          divisionName: "Khối sản phẩm Doanh nghiệp",
          employeeCode: "B06-0500",
          employeeId: 450,
          employeeName: "Hoàng Văn Giang",
          meetsUsageThreshold: true,
          oneAiTotalRequests: 10,
          positionCategory: "designer",
          positionName: "Nhân viên thiết kế",
          relevantToolsTotal: 90,
          shortName: "hvgiang",
          totalAllToolsRequests: 90,
        },
        {
          aiAgentTotalRequests: 1,
          clineActMode: 1,
          clinePlanMode: 1,
          clineTotalRequests: 2,
          cursorAgentRequests: 0,
          cursorAskRequests: 0,
          cursorCmdkUsages: 0,
          cursorEditRequests: 0,
          cursorTotalRequests: 0,
          divisionName: "Khối sản phẩm Cá nhân",
          employeeCode: "B07-0025",
          employeeId: 525,
          employeeName: "Vũ Thị Hà",
          meetsUsageThreshold: false,
          oneAiTotalRequests: 0,
          positionCategory: "tester",
          positionName: "Nhân viên kiểm thử",
          relevantToolsTotal: 2,
          shortName: "vtha",
          totalAllToolsRequests: 2,
        },
      ],
    });
  }),

  /**
   * Tình hình sử dụng AI toàn công ty
   */
  http.get("/reports/ai-agent/overall", async ({ request }) => {
    const url = new URL(request.url);
    const startDate = url.searchParams.get("startDate");
    const endDate = url.searchParams.get("endDate");

    if (!startDate || !endDate) {
      return new HttpResponse(
        {
          success: false,
          message: "Missing required parameters: startDate or endDate",
        },
        { status: 400 },
      );
    }

    await delay(500); // Giả lập độ trễ 500ms

    return HttpResponse.json({
      success: true,
      source: "mock",
      data: {
        calculationMode: {
          showNumbers: false,
          showPercentageOnly: true,
          type: "multi",
          workingDays: 1,
        },
        positionBasedFiltering: true,
        topProjects: [
          {
            divisionName: "Khối sản phẩm Doanh nghiệp",
            projectName: "Dự án IVAN",
            totalInProject: 9,
            usagePercentage: 100,
            usedCount: 6,
          },
          {
            divisionName: "Khối sản phẩm Cá nhân",
            projectName: "Dự án MISA SME",
            totalInProject: 15,
            usagePercentage: 80,
            usedCount: 12,
          },
          {
            divisionName: "Khối Công nghệ thông tin",
            projectName: "Dự án Gov",
            totalInProject: 20,
            usagePercentage: 90,
            usedCount: 18,
          },
        ],
        topUsers: [
          {
            department: "Dự án MISA Automation Sales",
            employeeCode: "B06-0381",
            employeeName: "Phí Hồng Mạnh",
            position: "Quản lý thi công",
            totalRequests: "106",
          },
          {
            department: "Trung tâm Phát triển Phần mềm",
            employeeCode: "B06-0123",
            employeeName: "Nguyễn Văn A",
            position: "Lập trình viên",
            totalRequests: "98",
          },
          {
            department: "Trung tâm Kinh doanh",
            employeeCode: "B06-0456",
            employeeName: "Trần Thị B",
            position: "Nhân viên kinh doanh",
            totalRequests: "85",
          },
        ],
        usageSummary: {
          usagePercentage: 66.44,
        },
      },
    });
  }),
];
